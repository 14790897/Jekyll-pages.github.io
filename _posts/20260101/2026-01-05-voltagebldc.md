---
title: 电机不仅会转，还会“咬人”：详解反电动势与FOC中的再生制动
date: 2026-01-05
categories:
  - tech
tags:
  - 电机控制
  - FOC
  - 反电动势
  - 再生制动
header:
  overlay_image: https://images.unsplash.com/photo-1618556391870-aa21debfe537?q=80&w=1074&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D
  overlay_filter: 0.5
  teaser: https://images.unsplash.com/photo-1618556391870-aa21debfe537?q=80&w=1074&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D
---




### 前言：消失的能量去哪了？

在刚开始做电机控制（Motor Control）的时候，我们往往有一个错觉：**电机就是一个“只吃不吐”的负载**。我们给它通电，它就转，把电能变成动能。

直到有一天，你在调试 FOC 算法时，给高速旋转的电机发了一个 `speed = 0` 的急刹车指令，只听“啪”的一声，你的驱动板冒烟了。你查了半天，发现耐压 60V 的 DRV8313 芯片竟然被击穿了。

你可能会纳闷：**明明我把电源关断了，为什么电压还会飙升？**

今天我们就来聊聊这个藏在电机里的“双面特工”——**反电动势（Back EMF）**，以及它在 FOC 控制中既是“天使”又是“魔鬼”的角色。

---

### 一、 物理本质：电机 = 发电机

首先要打破一个物理认知：**直流无刷电机（BLDC/PMSM）和发电机在结构上是完全一样的。**

只要电机的转子（永磁体）在旋转，它内部的线圈就在切割磁感线。根据法拉第电磁感应定律，线圈两端**一定**会产生感应电动势。

* **当你给的电压 > 感应电动势**：电流流向电机，它是**马达**。
* **当你给的电压 < 感应电动势**（比如刹车或外力旋转）：电流从电机流出，它是**发电机**。

你可以做一个最简单的实验：找一个无刷电机，不要接电源，把它的两根相线接在示波器上，用手用力搓一下轴。你会看到一个完美的正弦波（如果是 PMSM）——这就是电机在“说话”。

---

### 二、 天使的一面：无感 FOC 的“眼睛”

既然电机转动时会产生电压，聪明的工程师就想：**能不能利用这个电压来算出转子的位置？**

这就是 **无感 FOC（Sensorless FOC）** 的核心原理。

在没有编码器的情况下，我们的 MCU（比如 STM32）通过采样相电压或相电流，利用**观测器算法（Observer）**去捕捉这个反电动势的波形。

* 反电动势的相位，直接对应了转子的角度。
* 有了角度，FOC 就能进行坐标变换（Park/Clarke），实现闭环控制。

**这也解释了为什么无感 FOC 无法“零速闭环”：**
因为电机不转时，反电动势为 0，观测器就像“瞎子”一样什么都看不见。所以无感 FOC 必须先进行**开环强拖（Open-loop Ramp）**，先把电机拖到有一定速度，让反电动势大到能被检测出来，才能切入闭环。

---

### 三、 魔鬼的一面：Regen 导致的炸机

既然电机能发电，那这些电去了哪里？

当你在这个过程中进行**制动（Braking）**时，比如让一个高速旋转的电机突然停下，电机的惯性会带动转子继续转，此时它处于**发电模式**。

在 FOC 的电流环控制下，MOSFET 实际上充当了**整流器**的角色，将电机发出的交流电整流回直流母线（Vbus）。这个过程叫 **再生制动（Regenerative Braking / Regen）**。

#### 为什么会炸板子？

这就是 **“母线电压泵升”（Bus Pumping）** 现象：

1. 你用 24V 的开关电源给板子供电。
2. 电机急刹车，巨大的动能瞬间转化为电能倒灌回来。
3. 开关电源通常只能输出电流，不能吸收电流（Diode Blocking）。
4. 无处可去的电荷堆积在母线电容上，根据 ，**母线电压 Vbus 开始疯狂飙升**。
5. 24V -> 30V -> 50V -> **70V...**
6. **BOOM！** 你的驱动芯片（如 DRV8313，耐压极限 60V）承受不住过压，内部 MOS 管瞬间击穿。

---

### 四、 如何避坑？（给开发者的建议）

如果你正在调试 FOC，尤其是使用小容量驱动板时，请务必注意：

1. **温柔一点**：在调试阶段，尽量使用**斜坡减速（Ramp Down）**，不要直接给阶跃信号（Step Signal）让速度瞬间归零。
2. **电源选择**：调试时最好使用**电池**供电。电池是个巨大的电容，它可以从容地吸收倒灌回来的电流（相当于给电池充电）。
3. **大电容保平安**：如果你必须用开关电源，请在电源输入端并联一个大容量的电解电容（比如 1000uF 以上），作为能量缓冲区。
4. **硬件保护**：在高端的驱动器中，会设计**刹车电阻（Brake Resistor）**电路。当检测到母线电压过高时，电路导通，利用大功率电阻把多余的电能变成热量散发掉。

### 结语

FOC 算法之所以迷人，是因为它用数学驯服了物理。

理解“电机即发电机”这一物理本质，不仅能帮你写好无感观测器的代码，更能帮你在关键时刻保住你珍贵的驱动板。

**Stay Safe, Keep Spinning.**

---

*(完)*